<section class="contact" id="contact">
  <div class="contact__container">
    <h2 class="contact__title" appAnimateOnScroll>{{ 'contact.title' | translate }}</h2>
    <p class="contact__subtitle" appAnimateOnScroll>{{ 'contact.subtitle' | translate }}</p>

    @if (contactService.status() === 'success') {
      <div class="contact__success" role="alert" appAnimateOnScroll>
        <span class="contact__success-icon" aria-hidden="true">✓</span>
        <p>{{ 'contact.success' | translate }}</p>
        <button
          type="button"
          class="contact__btn contact__btn--secondary"
          (click)="contactService.resetStatus()"
        >
          {{ 'contact.sendAnother' | translate }}
        </button>
      </div>
    } @else {
      <form
        class="contact__form"
        [formGroup]="form"
        (ngSubmit)="onSubmit()"
        appAnimateOnScroll
        novalidate
      >
        <!-- Honeypot — hidden from real users -->
        <div class="contact__honeypot" aria-hidden="true">
          <label for="honeypot">{{ 'contact.honeypot' | translate }}</label>
          <input
            id="honeypot"
            formControlName="honeypot"
            type="text"
            tabindex="-1"
            autocomplete="off"
          />
        </div>

        <div class="contact__field">
          <label class="contact__label" for="name">{{ 'contact.name' | translate }}</label>
          <input
            id="name"
            class="contact__input"
            formControlName="name"
            type="text"
            [attr.placeholder]="'contact.placeholder.name' | translate"
            autocomplete="name"
            [attr.aria-invalid]="hasError('name')"
            [attr.aria-describedby]="hasError('name') ? 'name-error' : null"
          />
          @if (hasError('name')) {
            <span id="name-error" class="contact__error" role="alert">
              {{ getError('name') }}
            </span>
          }
        </div>

        <div class="contact__field">
          <label class="contact__label" for="email">{{ 'contact.email' | translate }}</label>
          <input
            id="email"
            class="contact__input"
            formControlName="email"
            type="email"
            placeholder="tu@email.com"
            autocomplete="email"
            [attr.aria-invalid]="hasError('email')"
            [attr.aria-describedby]="hasError('email') ? 'email-error' : null"
          />
          @if (hasError('email')) {
            <span id="email-error" class="contact__error" role="alert">
              {{ getError('email') }}
            </span>
          }
        </div>

        <div class="contact__field">
          <label class="contact__label" for="subject">{{ 'contact.subject' | translate }}</label>
          <input
            id="subject"
            class="contact__input"
            formControlName="subject"
            type="text"
            [attr.placeholder]="'contact.placeholder.subject' | translate"
            [attr.aria-invalid]="hasError('subject')"
            [attr.aria-describedby]="hasError('subject') ? 'subject-error' : null"
          />
          @if (hasError('subject')) {
            <span id="subject-error" class="contact__error" role="alert">
              {{ getError('subject') }}
            </span>
          }
        </div>

        <div class="contact__field">
          <label class="contact__label" for="message">{{ 'contact.message' | translate }}</label>
          <textarea
            id="message"
            class="contact__textarea"
            formControlName="message"
            [attr.placeholder]="'contact.placeholder.message' | translate"
            rows="5"
            [attr.aria-invalid]="hasError('message')"
            [attr.aria-describedby]="hasError('message') ? 'message-error' : null"
          ></textarea>
          @if (hasError('message')) {
            <span id="message-error" class="contact__error" role="alert">
              {{ getError('message') }}
            </span>
          }
        </div>

        @if (contactService.status() === 'error') {
          <div class="contact__alert contact__alert--error" role="alert">
            {{ contactService.errorMessage() }}
          </div>
        }

        <button
          type="submit"
          class="contact__btn contact__btn--primary"
          [disabled]="contactService.status() === 'sending'"
        >
          @if (contactService.status() === 'sending') {
            <span class="contact__spinner" aria-hidden="true"></span>
            {{ 'contact.sending' | translate }}
          } @else {
            {{ 'contact.send' | translate }}
          }
        </button>
      </form>
    }
  </div>
</section>
